<!DOCTYPE html>
<html lang="ja" xmlns="http://www.w3.org/1999/xhtml" prefix="og: http://ogp.me/ns#">
  <head>
    
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="format-detection" content="telephone=no">
<link rel="alternate" type="application/rss+xml" title="RSS Feed" href="http://k3kaimu.github.io/atom.xml">
<link rel="shortcut icon" href="/favicon.ico">

    <title> 05 反復処理 | Go to the future</title>
    
<meta property="og:type" content="blog">
<meta property="og:title" content="05 反復処理">
<meta property="og:description" content="{% tree %}

反復処理(ループ)というのは、作業の繰り返しのことです。
プログラムでのループは、「決まった状態になるまで続ける」という処理を記述します。

## while文

while文は典型的なループ処理を記述できる文です。
たとえば、自然数を足していき、和が100を超えた時点...">
<meta property="og:url" content="http://k3kaimu.github.io/dmanual/2013/05/26/dm-loop/">

<meta property="og:site_name" content="Go to the future">
<meta property="og:locale" content="ja_JP">
<meta name="twitter:card" content="summary">

<meta name="twitter:site" content="@k3_kaimu">


    
<link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootswatch/3.0.2/cerulean/bootstrap.min.css">
<link rel="stylesheet" href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.min.css">
<link rel="stylesheet" href="/assets/css/all.min.css">

    
<!--[if lt IE 9]>
  <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
  <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
<![endif]-->

  </head>
  <body>
    
<div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <a href="/" class="navbar-brand">Go to the future</a>
      <button class="navbar-toggle" type="button" data-toggle="collapse" data-target="#navbar-main">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
    </div>
    <div class="navbar-collapse collapse" id="navbar-main">
      <ul class="nav navbar-nav js_nav">
        <li><a href="/blog/">Blog</a></li>
        <li><a href="/dmanual/">DManual</a></li>
        <li><a href="/dtips/">DTips</a></li>
        <li><a href="/archives/">Index...</a></li>
      </ul>
      <div id="owner" itemprop="author copyrightHolder editor" itemscope itemtype="http://schema.org/Person">
        <ul class="nav navbar-nav navbar-right">
          <li class="dropdown">
            <a href="#" class="dropdown-toggle" data-toggle="dropdown">k3-kaimu <b class="caret"></b></a>
            <ul class="dropdown-menu">
              
              <li>
                
                <a href="https://www.github.com/k3kaimu" itemprop="sameAs" content="https://www.github.com/k3kaimu">
                  <i class="fa fa-github-square fa-lg"></i> GitHub
                </a>
              </li>
              
              
              <li>
                
                <a href="http://www.twitter.com/k3_kaimu" itemprop="sameAs" content="http://www.twitter.com/k3_kaimu">
                  <i class="fa fa-twitter-square fa-lg"></i> Twitter
                </a>
              </li>
              
              
              
              <li>
                <a href="/atom.xml">
                  <i class="fa fa-rss-square fa-lg fa-lg"></i> Rss
                </a>
              </li>
            </ul>
          </li>
        </ul>
      </div>
    </div>
  </div>
</div>

    <div id="content">
      <div class="container">
        <article itemscope itemtype="http://schema.org/Article" itemref="owner">
          
<div class="row">
  <div class="col-md-12 col-sm-12 col-xs-12">
    <div class="page-header">
      <h1 itemprop="url" content="http://k3kaimu.github.io/dmanual/2013/05/26/dm-loop/">
        <i class="fa fa-puzzle-piece fa-lg"></i> <span itemprop="name">05 反復処理</span>
      </h1>
    </div>
  </div>
</div>

          <div class="row">
            <div class="col-md-12 col-sm-12 col-xs-12">
              <div itmprop="articleBody">
                <p><h2 class="content_tree">Contents</h2><div class="content_tree_list"><ul><li>while文</li><ul><li>無限ループ</li></ul><li>do文</li><li>for文</li><li>foreach range文</li><ul><li>foreach_reverse</li></ul><li>ループを抜ける, 次に進める</li><ul><li>ループから抜け出す</li><li>ループを次に進める</li></ul><li>問題 -&gt; <a href="%7B%7B%20site.baseurl%20%7D%7D/dmanual/answer#loop">解答</a></li><li>おわりに</li><li>キーワード</li><li>仕様</li></ul></ul></div></p>

<p>反復処理(ループ)というのは、作業の繰り返しのことです。
プログラムでのループは、「決まった状態になるまで続ける」という処理を記述します。</p>

<h2>while文</h2>

<p>while文は典型的なループ処理を記述できる文です。
たとえば、自然数を足していき、和が100を超えた時点での値を出力したいとします。</p>
<div class="highlight"><pre><code class="language-d" data-lang="d"><span class="c1">/// test00601.d</span>
<span class="k">import</span> <span class="n">std</span><span class="p">.</span><span class="n">stdio</span><span class="p">;</span>

<span class="kt">void</span> <span class="n">main</span><span class="p">()</span>
<span class="p">{</span>
    <span class="kt">int</span> <span class="n">n</span> <span class="p">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">sum</span><span class="p">;</span>

    <span class="k">while</span><span class="p">(</span><span class="n">sum</span> <span class="p">&lt;</span> <span class="mi">100</span><span class="p">){</span>      <span class="c1">// (sum &lt; 100) がtrueの間は繰り返す</span>
        <span class="n">sum</span> <span class="p">+=</span> <span class="n">n</span><span class="p">;</span>
        <span class="p">++</span><span class="n">n</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="n">writeln</span><span class="p">(</span><span class="n">n</span><span class="p">-</span><span class="mi">1</span><span class="p">);</span>
    <span class="n">writeln</span><span class="p">(</span><span class="n">sum</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div><div class="highlight"><pre><code class="language-text" data-lang="text">$ rdmd test00601.d
14
105
</code></pre></div>
<p>例の<code>while</code>は、数学をしらない人間が愚直に100になるまで足していく、という作業をそのまま表しています。
実際に<code>14</code>までの和は、<code>14 * (14 + 1) / 2 =&gt; 105</code>ですし、<code>13</code>までの和は<code>105 - 14 =&gt; 91</code>となりますから、正常に計算できているようです。</p>

<p>最後のほうで<code>writeln(n-1);</code>となっていますが、なぜ<code>n</code>じゃなくて<code>n-1</code>なのでしょうね？
少し考えればわかると思いますので、処理の流れを理解するいい練習になると思います。</p>

<p>さて、<code>while</code>の詳細ですが、<code>while</code>は<code>if</code>同様に<code>while(&lt;expression&gt;) &lt;statement&gt;</code>という形式を取ります。
<code>while</code>の意味は、「<code>&lt;expression&gt;</code>が<code>true</code>の間、<code>&lt;statement&gt;</code>を実行する」ということです。
もし、最初から<code>&lt;expression&gt;</code>が<code>false</code>であればどうなるでしょうか？
<code>&lt;statement&gt;</code>は一度も実行されなくなります。</p>
<div class="highlight"><pre><code class="language-d" data-lang="d"><span class="c1">/// test00602.d</span>
<span class="k">import</span> <span class="n">std</span><span class="p">.</span><span class="n">stdio</span><span class="p">;</span>

<span class="kt">void</span> <span class="n">main</span><span class="p">()</span>
<span class="p">{</span>
    <span class="k">while</span><span class="p">(</span><span class="kc">false</span><span class="p">)</span>
        <span class="n">writeln</span><span class="p">(</span><span class="s">&quot;foooooooo&quot;</span><span class="p">);</span>

    <span class="n">writeln</span><span class="p">(</span><span class="s">&quot;bar&quot;</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div><div class="highlight"><pre><code class="language-text" data-lang="text">$ rdmd test00602.d
bar
</code></pre></div>
<h3>無限ループ</h3>

<p>無限ループとは、入ったら永続的に実行され続けるループです。
<code>while</code>は無限ループを簡単に表現できます。</p>
<div class="highlight"><pre><code class="language-d" data-lang="d"><span class="k">while</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>            <span class="c1">//while(true)でもOK</span>
    <span class="p">&lt;</span><span class="n">statement</span><span class="p">&gt;</span>
</code></pre></div>
<p>無限ループは後述する<code>for</code>で<code>for(;;)</code>とも書かれたりします。</p>

<h2>do文</h2>

<p><code>while</code>文の場合、条件<code>&lt;expression&gt;</code>が最初から<code>false</code>であれば一度も実行されないと書きました。
でも、一度は必ず実行して欲しい時があります。
その要望に答えるために、<code>do</code>文といい<code>do &lt;statement&gt; while(&lt;expression&gt;);</code>という文があります。</p>
<div class="highlight"><pre><code class="language-d" data-lang="d"><span class="c1">/// test00603.d</span>
<span class="k">import</span> <span class="n">std</span><span class="p">.</span><span class="n">stdio</span><span class="p">;</span>

<span class="kt">void</span> <span class="n">main</span><span class="p">()</span>
<span class="p">{</span>
    <span class="kt">int</span> <span class="n">i</span><span class="p">;</span>

    <span class="k">do</span>
        <span class="n">writeln</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
    <span class="k">while</span><span class="p">((++</span><span class="n">i</span><span class="p">)</span> <span class="p">&lt;</span> <span class="mi">5</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div><div class="highlight"><pre><code class="language-text" data-lang="text">$ rdmd test00603.d
0
1
2
3
4
</code></pre></div>
<p><code>do</code>文の処理の流れは、一度<code>&lt;stamenet&gt;</code>を実行してから、<code>&lt;expression&gt;</code>を評価し、<code>true</code>であればまた<code>&lt;statement&gt;</code>を実行し、<code>&lt;expression&gt;</code>を評価し、...というようになります。</p>

<p><code>while</code>文とは、<code>&lt;statement&gt;</code>の実行と<code>&lt;expression&gt;</code>の評価の順序が入れ替わっただけですが、これによって絶対に1回は<code>&lt;statement&gt;</code>が実行されます。</p>

<h2>for文</h2>

<p>一番最初に示した例<code>test00601.d</code>のループでは、条件式<code>sum &lt; 100</code>と更新式<code>++n</code>を持つことがわかります。また、よく考えると<code>int n = 1, sum;</code>というのは<code>n = 1; sum = 0;</code>を表しているとも考えられます。これを初期化式といいます。</p>

<p>以上をまとめると、<code>test00601.d</code>のループには条件式と更新式、初期化式があることがわかりました。
実は、この3つを綺麗に書ける文があります。
<code>for</code>文といいます。</p>
<div class="highlight"><pre><code class="language-d" data-lang="d"><span class="c1">/// test00604.d</span>
<span class="k">import</span> <span class="n">std</span><span class="p">.</span><span class="n">stdio</span><span class="p">;</span>

<span class="kt">void</span> <span class="n">main</span><span class="p">()</span>
<span class="p">{</span>
    <span class="kt">int</span> <span class="n">n</span><span class="p">,</span> <span class="n">sum</span><span class="p">;</span>

    <span class="k">for</span><span class="p">(</span><span class="n">n</span> <span class="p">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">sum</span> <span class="p">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">sum</span> <span class="p">&lt;</span> <span class="mi">100</span><span class="p">;</span> <span class="p">++</span><span class="n">n</span><span class="p">)</span>
        <span class="n">sum</span> <span class="p">+=</span> <span class="n">n</span><span class="p">;</span>

    <span class="n">writeln</span><span class="p">(</span><span class="n">n</span><span class="p">-</span><span class="mi">1</span><span class="p">);</span>
    <span class="n">writeln</span><span class="p">(</span><span class="n">sum</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div><div class="highlight"><pre><code class="language-text" data-lang="text">$ rdmd test00604.d
14
105
</code></pre></div>
<p><code>for</code>文は、<code>for(初期化子; 条件式; 更新式) &lt;statement&gt;</code>という形式をとります。
処理の流れは、まず初期化子が実行され、条件式により判定されます。条件式が<code>true</code>であれば、文<code>&lt;statement&gt;</code>が実行されます。
<code>&lt;statement&gt;</code>が終われば、更新式が評価され、また条件式が通れば<code>&lt;statement&gt;</code>が実行され、更新式が評価され、....を繰り返します。</p>

<p><code>for</code>文を<code>while</code>文で書き換えてみると、次のようになります。</p>
<div class="highlight"><pre><code class="language-d" data-lang="d"><span class="p">{</span>                   <span class="c1">//新しいスコープを作る</span>
    <span class="err">初期化子</span><span class="p">;</span>
    <span class="k">while</span><span class="p">(</span><span class="err">条件式</span><span class="p">){</span>
        <span class="p">&lt;</span><span class="n">statement</span><span class="p">&gt;</span>
        <span class="err">更新式</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>初期化式と書かずに初期化子と書いたのには理由があって、初期化子では変数の宣言ができます。
次の<code>for</code>文を使ったループの記述は、C言語の至る所で見る典型的な<code>for</code>の使い方です。<br>
(D言語では、後述する<code>foreach</code>を普通は使います)</p>
<div class="highlight"><pre><code class="language-d" data-lang="d"><span class="c1">/// test00605.d</span>
<span class="k">import</span> <span class="n">std</span><span class="p">.</span><span class="n">stdio</span><span class="p">;</span>

<span class="kt">void</span> <span class="n">main</span><span class="p">()</span>
<span class="p">{</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="mi">5</span><span class="p">;</span> <span class="p">++</span><span class="n">i</span><span class="p">)</span>
        <span class="n">writeln</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div><div class="highlight"><pre><code class="language-text" data-lang="text">$ rdmd test00605.d
0
1
2
3
4
</code></pre></div>
<p>変数<code>i</code>のスコープは、<code>for</code>文内のみなので、<code>for</code>文の外側では<code>i</code>にアクセスできません。</p>

<h2>foreach range文</h2>

<p><code>foreach range</code>文は、<code>for</code>文の特殊形式だと言えます。
<code>foreach(&lt;identifier&gt;; &lt;exprLower&gt; .. &lt;exprUpper&gt;) &lt;statement&gt;</code>という形式をとります。</p>

<p><code>for</code>文で<code>foreach range</code>文を表すと、次のようになります。</p>
<div class="highlight"><pre><code class="language-d" data-lang="d"><span class="k">foreach</span><span class="p">(&lt;</span><span class="n">identifier</span><span class="p">&gt;;</span> <span class="p">&lt;</span><span class="n">exprLower</span><span class="p">&gt;</span> <span class="p">..</span> <span class="p">&lt;</span><span class="n">exprUpper</span><span class="p">&gt;)</span>
    <span class="p">&lt;</span><span class="n">statement</span><span class="p">&gt;</span>

<span class="err">と、以下は同等</span>

<span class="p">{</span>                                       <span class="c1">// 新しいスコープを作る</span>
    <span class="k">auto</span> <span class="n">index</span> <span class="p">=</span> <span class="p">&lt;</span><span class="n">exprLower</span><span class="p">&gt;;</span>           <span class="c1">// autoは型を自動でつけてくれる</span>
    <span class="k">auto</span> <span class="n">exprUpper</span> <span class="p">=</span> <span class="p">&lt;</span><span class="n">exprUpper</span><span class="p">&gt;;</span>
    <span class="k">for</span><span class="p">(;</span> <span class="n">index</span> <span class="p">&lt;</span> <span class="n">exprUpper</span><span class="p">;</span> <span class="p">++</span><span class="n">index</span><span class="p">){</span>
        <span class="k">auto</span> <span class="p">&lt;</span><span class="n">identifier</span><span class="p">&gt;</span> <span class="p">=</span> <span class="n">index</span><span class="p">;</span>      <span class="c1">// &lt;identifier&gt;はindexのコピー</span>
        <span class="p">&lt;</span><span class="n">statement</span><span class="p">&gt;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="err">さらに</span><span class="k">while</span><span class="err">で書き直すと</span>

<span class="p">{</span>                                       <span class="c1">// 新しいスコープを作る</span>
    <span class="k">auto</span> <span class="n">index</span> <span class="p">=</span> <span class="p">&lt;</span><span class="n">exprLower</span><span class="p">&gt;;</span>           <span class="c1">// autoは型を自動でつけてくれる</span>
    <span class="k">auto</span> <span class="n">exprUpper</span> <span class="p">=</span> <span class="p">&lt;</span><span class="n">exprUpper</span><span class="p">&gt;;</span>
    <span class="k">while</span><span class="p">(</span><span class="n">index</span> <span class="p">&lt;</span> <span class="n">exprUpper</span><span class="p">){</span>
        <span class="k">auto</span> <span class="p">&lt;</span><span class="n">identifier</span><span class="p">&gt;</span> <span class="p">=</span> <span class="n">index</span><span class="p">;</span>      <span class="c1">// &lt;identifier&gt;はindexのコピー</span>
        <span class="p">&lt;</span><span class="n">statement</span><span class="p">&gt;</span>
        <span class="p">++</span><span class="n">index</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>たとえば、「1から10までの総和を取りたい」のなら、次のように記述します。</p>
<div class="highlight"><pre><code class="language-d" data-lang="d"><span class="c1">/// test00606.d</span>
<span class="k">import</span> <span class="n">std</span><span class="p">.</span><span class="n">stdio</span><span class="p">;</span>

<span class="kt">void</span> <span class="n">main</span><span class="p">()</span>
<span class="p">{</span>
    <span class="kt">int</span> <span class="n">sum</span><span class="p">;</span>

    <span class="k">foreach</span><span class="p">(</span><span class="n">i</span><span class="p">;</span> <span class="mi">1</span> <span class="p">..</span> <span class="mi">11</span><span class="p">)</span> <span class="c1">//[1, 11)</span>
        <span class="n">sum</span> <span class="p">+=</span> <span class="n">i</span><span class="p">;</span>

    <span class="n">writeln</span><span class="p">(</span><span class="n">sum</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div><div class="highlight"><pre><code class="language-d" data-lang="d"><span class="p">$</span> <span class="n">rdmd</span> <span class="n">test00606</span><span class="p">.</span><span class="n">d</span>
<span class="mi">55</span>
</code></pre></div>
<p><code>foreach range</code>文は、<code>for</code>文より用法が限られますが、単純な範囲を回すループを記述するのに役立ちます。</p>

<ul>
<li>明示的に<code>&lt;identifier&gt;</code>の型を記述することも可能です。</li>
</ul>
<div class="highlight"><pre><code class="language-d" data-lang="d"><span class="k">foreach</span><span class="p">(</span><span class="kt">ulong</span> <span class="n">i</span><span class="p">;</span> <span class="mi">0</span> <span class="p">..</span> <span class="mi">100</span><span class="p">)</span>
    <span class="n">foo</span><span class="p">();</span>
</code></pre></div>
<ul>
<li><code>foreach(ref &lt;identifier&gt;; &lt;exprLower&gt; .. &lt;experUpper&gt;)</code>とすることで、ループのインデックスを操作可能です。</li>
</ul>
<div class="highlight"><pre><code class="language-d" data-lang="d"><span class="k">foreach</span><span class="p">(</span><span class="k">ref</span> <span class="p">&lt;</span><span class="n">identifier</span><span class="p">&gt;;</span> <span class="p">&lt;</span><span class="n">exprLower</span><span class="p">&gt;</span> <span class="p">..</span> <span class="p">&lt;</span><span class="n">exprUpper</span><span class="p">&gt;)</span>
    <span class="p">&lt;</span><span class="n">statement</span><span class="p">&gt;</span>

<span class="err">と、以下は同等</span>

<span class="p">{</span>                                       <span class="c1">// 新しいスコープを作る</span>
    <span class="k">auto</span> <span class="p">&lt;</span><span class="n">identifier</span><span class="p">&gt;</span> <span class="p">=</span> <span class="p">&lt;</span><span class="n">exprLower</span><span class="p">&gt;;</span>    <span class="c1">// autoは型を自動でつけてくれる</span>
    <span class="k">auto</span> <span class="n">exprUpper</span> <span class="p">=</span> <span class="p">&lt;</span><span class="n">exprUpper</span><span class="p">&gt;;</span>
    <span class="k">for</span><span class="p">(;</span> <span class="p">&lt;</span><span class="n">identifer</span><span class="p">&gt;</span> <span class="p">&lt;</span> <span class="n">exprUpper</span><span class="p">;</span> <span class="p">++&lt;</span><span class="n">identifier</span><span class="p">&gt;)</span>
        <span class="p">&lt;</span><span class="n">statement</span><span class="p">&gt;</span>
<span class="p">}</span>

<span class="err">さらに</span><span class="k">while</span><span class="err">で書き直すと</span>

<span class="p">{</span>                                       <span class="c1">// 新しいスコープを作る</span>
    <span class="k">auto</span> <span class="p">&lt;</span><span class="n">identifier</span><span class="p">&gt;</span> <span class="p">=</span> <span class="p">&lt;</span><span class="n">exprLower</span><span class="p">&gt;;</span>    <span class="c1">// autoは型を自動でつけてくれる</span>
    <span class="k">auto</span> <span class="n">exprUpper</span> <span class="p">=</span> <span class="p">&lt;</span><span class="n">exprUpper</span><span class="p">&gt;;</span>
    <span class="k">while</span><span class="p">(&lt;</span><span class="n">identifer</span><span class="p">&gt;</span> <span class="p">&lt;</span> <span class="n">exprUpper</span><span class="p">){</span>
        <span class="p">&lt;</span><span class="n">statement</span><span class="p">&gt;</span>
        <span class="p">++&lt;</span><span class="n">identifier</span><span class="p">&gt;;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="err">例を示すと、以下のようになります。</span>

<span class="p">~~~~</span><span class="n">d</span>
<span class="c1">/// test00607.d</span>
<span class="k">import</span> <span class="n">std</span><span class="p">.</span><span class="n">stdio</span><span class="p">;</span>

<span class="kt">void</span> <span class="n">main</span><span class="p">()</span>
<span class="p">{</span>
    <span class="k">foreach</span><span class="p">(</span><span class="n">i</span><span class="p">;</span> <span class="mi">0</span> <span class="p">..</span> <span class="mi">10</span><span class="p">){</span>
        <span class="n">writef</span><span class="p">(</span><span class="s">&quot;%s, &quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">);</span>
        <span class="p">++</span><span class="n">i</span><span class="p">;</span>                <span class="c1">// refナシなので意味なし</span>
    <span class="p">}</span>

    <span class="n">writeln</span><span class="p">();</span>

    <span class="k">foreach</span><span class="p">(</span><span class="k">ref</span> <span class="n">i</span><span class="p">;</span> <span class="mi">0</span> <span class="p">..</span> <span class="mi">10</span><span class="p">){</span>
        <span class="n">writef</span><span class="p">(</span><span class="s">&quot;%s, &quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">);</span>
        <span class="p">++</span><span class="n">i</span><span class="p">;</span>                <span class="c1">// refアリなので見かけ上2ずつ進む</span>
    <span class="p">}</span>

<span class="p">}</span>
</code></pre></div><div class="highlight"><pre><code class="language-text" data-lang="text">$ rdmd test00607.d
0, 1, 2, 3, 4, 5, 6, 7, 8, 9,
0, 2, 4, 6, 8,
</code></pre></div>
<ul>
<li>イテレート可能な型<br>
<code>foreach range</code>文で、辿る範囲の型はインクリメント<code>++</code>と等価テスト<code>==</code>が定義されていればどのような型でも可能です。
たとえば、<code>double</code>などの浮動小数点型や、以下の例中に定義されている<code>struct Incrementable</code>は<code>++</code>と<code>==</code>が可能なので<code>foreach range</code>で使えます。</li>
</ul>
<div class="highlight"><pre><code class="language-d" data-lang="d"><span class="c1">/// test00608.d</span>
<span class="k">import</span> <span class="n">std</span><span class="p">.</span><span class="n">stdio</span><span class="p">;</span>

<span class="kt">void</span> <span class="n">main</span><span class="p">()</span>
<span class="p">{</span>
    <span class="k">foreach</span><span class="p">(</span><span class="n">i</span><span class="p">;</span> <span class="mf">0.5</span> <span class="p">..</span> <span class="mf">5.5</span><span class="p">)</span>
        <span class="n">writeln</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>


    <span class="k">foreach</span><span class="p">(</span><span class="n">e</span><span class="p">;</span> <span class="n">Incrementable</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="p">..</span>  <span class="n">Incrementable</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
        <span class="n">writeln</span><span class="p">(</span><span class="n">e</span><span class="p">);</span>
<span class="p">}</span>


<span class="k">struct</span> <span class="n">Incrementable</span>
<span class="p">{</span>
    <span class="k">ref</span> <span class="k">typeof</span><span class="p">(</span><span class="k">this</span><span class="p">)</span> <span class="n">opUnary</span><span class="p">(</span><span class="nb">string</span> <span class="n">s</span> <span class="p">:</span> <span class="s">&quot;++&quot;</span><span class="p">)()</span>
    <span class="p">{</span>
        <span class="p">++</span><span class="n">_value</span><span class="p">;</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
    <span class="p">}</span>

  <span class="k">private</span><span class="p">:</span>
    <span class="kt">int</span> <span class="n">_value</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div><div class="highlight"><pre><code class="language-text" data-lang="text">$ rdmd test00608.d
0.5
1.5
2.5
3.5
4.5
Incrementable(0)
Incrementable(1)
Incrementable(2)
Incrementable(3)
Incrementable(4)
Incrementable(5)
Incrementable(6)
Incrementable(7)
Incrementable(8)
Incrementable(9)
</code></pre></div>
<h3>foreach_reverse</h3>

<p><code>foreach range</code>文には、逆順に辿る<code>foreach_reverse</code>というものがあります。</p>
<div class="highlight"><pre><code class="language-d" data-lang="d"><span class="c1">/// test00609.d</span>
<span class="k">import</span> <span class="n">std</span><span class="p">.</span><span class="n">stdio</span><span class="p">;</span>

<span class="kt">void</span> <span class="n">main</span><span class="p">()</span>
<span class="p">{</span>
    <span class="k">foreach</span><span class="p">(</span><span class="n">i</span><span class="p">;</span> <span class="mi">0</span> <span class="p">..</span> <span class="mi">5</span><span class="p">)</span>
        <span class="n">writeln</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>

    <span class="k">foreach_reverse</span><span class="p">(</span><span class="n">i</span><span class="p">;</span> <span class="mi">0</span> <span class="p">..</span> <span class="mi">5</span><span class="p">)</span>
        <span class="n">writeln</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div><div class="highlight"><pre><code class="language-d" data-lang="d"><span class="p">$</span> <span class="n">rdmd</span> <span class="n">test00609</span><span class="p">.</span><span class="n">d</span>
<span class="mi">0</span>
<span class="mi">1</span>
<span class="mi">2</span>
<span class="mi">3</span>
<span class="mi">4</span>
<span class="mi">4</span>
<span class="mi">3</span>
<span class="mi">2</span>
<span class="mi">1</span>
<span class="mi">0</span>
</code></pre></div>
<h2>ループを抜ける, 次に進める</h2>

<p>現実から抜け出したいことはよくありますよね。
少なくとも私は、毎日のように「現実を壊したい、人生をコンティニューしたい」と思ってます。
プログラムでも、ループから抜けだしたいことはありますし、コンティニューしたいことがあるんです。</p>

<h3>ループから抜け出す</h3>

<p><code>break</code>文は、ループという檻を破壊します。
つまり、ループから抜け出します。</p>
<div class="highlight"><pre><code class="language-d" data-lang="d"><span class="c1">/// test00610.d</span>
<span class="k">import</span> <span class="n">std</span><span class="p">.</span><span class="n">stdio</span><span class="p">;</span>

<span class="kt">void</span> <span class="n">main</span><span class="p">()</span>
<span class="p">{</span>
    <span class="k">foreach</span><span class="p">(</span><span class="n">i</span><span class="p">;</span> <span class="mi">0</span> <span class="p">..</span> <span class="mi">100</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="n">i</span> <span class="p">&gt;</span> <span class="mi">10</span><span class="p">)</span>
            <span class="k">break</span><span class="p">;</span>

        <span class="n">writeln</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div><div class="highlight"><pre><code class="language-text" data-lang="text">$ rdmd test00610.d
0
1
2
3
4
5
6
7
8
9
10
</code></pre></div>
<p><code>break</code>文は実行されれば、最も内側のループを抜け出します。
ネストされた複数のループを抜けたい場合には、ループ文にラベルをつけて解決します。</p>
<div class="highlight"><pre><code class="language-d" data-lang="d"><span class="k">import</span> <span class="n">std</span><span class="p">.</span><span class="n">stdio</span><span class="p">;</span>

<span class="kt">void</span> <span class="n">main</span><span class="p">()</span>
<span class="p">{</span>
  <span class="n">LbreakLabel0</span><span class="p">:</span>
    <span class="k">while</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
      <span class="n">LbreakLabel1</span><span class="p">:</span>
        <span class="k">while</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">while</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
                <span class="k">break</span> <span class="n">LbreakLabel0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<p><code>break LbreakLabel0;</code>が無ければ、無限ループになって何時までたっても終わらなくなります。</p>

<h3>ループを次に進める</h3>

<p>たとえば、1~50までの偶数のみの総和は<code>continue</code>を使うと次のようになります。</p>
<div class="highlight"><pre><code class="language-d" data-lang="d"><span class="kt">void</span> <span class="n">main</span><span class="p">()</span>
<span class="p">{</span>
    <span class="kt">int</span> <span class="n">sum</span><span class="p">;</span>

    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;=</span> <span class="mi">50</span><span class="p">;</span> <span class="p">++</span><span class="n">i</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="n">i</span> <span class="p">%</span> <span class="mi">2</span> <span class="p">!=</span> <span class="mi">0</span><span class="p">)</span>
            <span class="k">continue</span><span class="p">;</span>

        <span class="n">sum</span> <span class="p">+=</span> <span class="n">i</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="n">writeln</span><span class="p">(</span><span class="n">sum</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
<p>どういうことかというと、<code>continue</code>は文の実行を中止して、更新式<code>++i</code>と条件式<code>i &lt;= 50</code>を評価します。
そして、その後また最初から文を実行します。</p>

<p>別の表現を使用すると、「ループされる文の最後までジャンプ」します。
例では、<code>sum += i;</code>の後までジャンプすると捉えることもできます。</p>

<p>また、<code>continue</code>もラベルを指定することができます。</p>
<div class="highlight"><pre><code class="language-d" data-lang="d"><span class="k">import</span> <span class="n">std</span><span class="p">.</span><span class="n">stdio</span><span class="p">;</span>

<span class="kt">void</span> <span class="n">main</span><span class="p">()</span>
<span class="p">{</span>
  <span class="n">LcontinueLabel</span><span class="p">:</span>
    <span class="k">do</span><span class="p">{</span>
        <span class="k">while</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
          <span class="n">LcontinueLabel1</span><span class="p">:</span>
            <span class="k">while</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
                <span class="k">continue</span> <span class="n">LcontinueLabel</span><span class="p">;</span>
    <span class="p">}</span><span class="k">while</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
<h2>問題 -&gt; <a href="/dmanual/answer#loop">解答</a></h2>

<ul>
<li><p><code>test00601.d</code>で、<code>writeln(n);</code>でなくて<code>writeln(n-1);</code>となっている理由は？</p></li>
<li><p><code>foreach_reverse</code>を<code>for</code>文で書き直すとどうなるでしょうか？</p></li>
<li><p>1000未満の自然数で、3の倍数もしくは5の倍数の総和を計算するプログラムをループを使って作ってください。(Project Euler Problem 1より)</p></li>
<li><p>フィボナッチ数列<code>1, 2, 3, 5, 8, ...</code>を考える。数列の項の値が400万以下の偶数である項の合計を求めるプログラムを作ってください。(Project Euler Problem 2より)  </p></li>
<li><p>最初の100個の自然数の2乗の総和と、総和の2乗の差を出力するプログラムを<code>for</code>を使って作ってください。その後、<code>foreach</code>を使用するように書き換えてみましょう。(Project Euler Problem 6より)</p></li>
<li><p><code>while(1)</code>, <code>break</code>, <code>continue</code>を使って、「標準入力から得点を受け取り、平均を計算する。ただし、負の数を受け取った場合には平均と合計点を出力して終了する。また、10未満の得点は無視して平均や合計には含めないとする」ようなプログラムを作ってください。</p></li>
</ul>

<h2>おわりに</h2>

<p>おつかれさまです。
ループが書けるようになると、相当プログラムの幅が広くなります。
そのため、今回の問題の量はいつもより多いと思います。</p>

<p>次はその他の制御文として、<code>goto</code>, <code>switch</code>の紹介をしたいと思います。</p>

<h2>キーワード</h2>

<ul>
<li><code>while</code></li>
<li><code>do-while</code></li>
<li><code>for</code></li>
<li><code>foreach range</code></li>
<li><code>break</code></li>
<li><code>continue</code></li>
</ul>

<h2>仕様</h2>

<ul>
<li><code>while</code>: <a href="http://dlang.org/statement.html#WhileStatement">英語</a> <a href="http://www.kmonos.net/alang/d/statement.html#WhileStatement">日本語</a></li>
<li><code>do-while</code>: <a href="http://dlang.org/statement.html#DoStatement">英語</a> <a href="http://www.kmonos.net/alang/d/statement.html#DoStatement">日本語</a></li>
<li><code>for</code>: <a href="http://dlang.org/statement.html#ForStatement">英語</a> <a href="http://www.kmonos.net/alang/d/statement.html#ForStatement">日本語</a></li>
<li><code>foreach range</code>: <a href="http://dlang.org/statement.html#ForeachRangeStatement">英語</a> <a href="http://www.kmonos.net/alang/d/statement.html#ForeachRangeStatement">日本語</a></li>
<li><code>break</code>: <a href="http://dlang.org/statement.html#BreakStatement">英語</a> <a href="http://www.kmonos.net/alang/d/statement.html#BreakStatement">日本語</a></li>
<li><code>continue</code>: <a href="http://dlang.org/statement.html#ContinueStatement">英語</a> <a href="http://www.kmonos.net/alang/d/statement.html#ContinueStatement">日本語</a></li>
</ul>

              </div>
            </div>
          </div>
          <div class="row">
  <div class="col-md-12 col-sm-12 col-xs-12">
    <div class="page-footer">
      <div class="list-group">
        <a href="/archives/#y-2013" class="list-group-item col-md-3 col-sm-4 col-xs-6">
          <i class="fa fa fa-archive fa-lg"></i> 
          <em itemprop="datePublished" content="2013-05-26">
            26 May 2013
          </em>
        </a>
        
        <a href="/categories/#dmanual" class="list-group-item col-md-3 col-sm-4 col-xs-6">
          <i class="fa fa-folder-open fa-lg"></i> <em itemprop="keywords">Dmanual</em>
          <span class="badge">15</span>
        </a>
        
        
        <a href="/tags/#dmanual" class="list-group-item col-md-3 col-sm-4 col-xs-6">
          <i class="fa fa-tag fa-lg"></i> <em itemprop="keywords">dmanual</em>
          <span class="badge">16</span>
        </a>
        
    </div>
    <div id="disqus_thread"></div>
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'dmanual'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
  </div>
</div>
        </article>
      </div>
    </div>
    
<div class="footer">
  <div class="container">
    <hr/>
    <div class="row">
      <div class="col-md-12 col-sm-12 col-xs-12">
        <ul class="nav nav-pills">
          
          <li>
            <a href="https://www.github.com/k3kaimu">
              <i class="fa fa-github-square fa-lg"></i> GitHub
            </a>
          </li>
          
          
          <li>
            <a href="http://www.twitter.com/k3_kaimu">
              <i class="fa fa-twitter-square fa-lg"></i> Twitter
            </a>
          </li>
          
          
          
          <li>
            <a href="/atom.xml">
              <i class="fa fa-rss-square fa-lg"></i> Rss
            </a>
          </li>
          <li class="pull-right visible-md visible-lg">
            <a href="#top">
              <i class="fa fa-arrow-circle-up fa-lg"></i> Back to top
            </a>
          </li>
        </ul>
      </div>
    </div>
    <div class="row">
      <div class="col-md-12 col-sm-12 col-xs-12">        
        <p>
          &copy; k3-kaimu 2014 
          with help from <a href="https://github.com/ogaclejapan/jekyllstrap" target="_blank" title="jekyllstrap is Jekyll template based on Bootstrap.">Jekyllstrap</a>.
        </p>
        <p>
          Based on <a href="http://jekyllrb.com/" target="_blank">Jekyll</a>. 
          Themes from <a href="http://getbootstrap.com/" target="_blank">Bootstrap</a> and <a href="http://bootswatch.com/" target="_blank">Bootswatch</a>. 
          Icons from <a href="http://fontawesome.io/" target="_blank">Font Awesome</a>.
        </p>
      </div>
    </div>
  </div>
</div>


    
<div id="back-to-top">
  <a href="#top"><i class="fa fa-arrow-circle-up fa-5x"></i></a>
</div>

    
<script src="//code.jquery.com/jquery-2.0.3.min.js"></script>
<script src="//netdna.bootstrapcdn.com/bootstrap/3.0.3/js/bootstrap.min.js"></script>
<script src="/assets/js/all.min.js"></script>



    


  </body>
</html>
